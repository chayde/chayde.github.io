<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 1: Docker" /><meta property="og:locale" content="en" /><meta name="description" content="Docker" /><meta property="og:description" content="Docker" /><link rel="canonical" href="https://docs.chayde.com/posts/docker-crash-course/" /><meta property="og:url" content="https://docs.chayde.com/posts/docker-crash-course/" /><meta property="og:site_name" content="Mark’s Documentation Site" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-30T19:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 1: Docker" /><meta name="twitter:site" content="@thechayde" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-30T21:05:37-04:00","datePublished":"2022-07-30T19:00:00-04:00","description":"Docker","headline":"Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 1: Docker","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.chayde.com/posts/docker-crash-course/"},"url":"https://docs.chayde.com/posts/docker-crash-course/"}</script><title>Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 1: Docker | Mark's Documentation Site</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mark's Documentation Site"><meta name="application-name" content="Mark's Documentation Site"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/corner.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mark's Documentation Site</a></div><div class="site-subtitle font-italic">A documentation site built for my homelab... and some other stuff.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/chayde" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/thechayde" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mark','chayde.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 1: Docker</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 1: Docker</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1659222000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 30, 2022 </em> </span> <span> Updated <em class="" data-ts="1659229537" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 30, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/thechayde">Mark Riggs</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1567 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><h1 id="docker">Docker</h1><p>These notes are going to be my refrence to a blog post series a friend of mine sent me for the topic: <a href="https://blog.gruntwork.io/the-docker-kubernetes-terraform-and-aws-crash-course-series-dca343ba1274">Crash Course</a> As I work through the posts I’ll be including relevant commands here for refrence later.</p><h2 id="initial-setup"><span class="mr-2">Initial Setup</span><a href="#initial-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>My setup will be using a host I created named docker01.chayde.lab (Ubuntu VM with 32g ram, 100g HDD, and 4 vCPU) for any examples I can run on local instances. Ubuntu 22.04 has been installed, initial user setup has been performed and both docker and docker-compose have been installed. I followed my previous post for installing <a href="https://docs.chayde.com/posts/install-docker-and-docker-compose/">docker and docker-compose</a></p><h2 id="run-your-first-docker-container"><span class="mr-2">Run Your First Docker Container</span><a href="#run-your-first-docker-container" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To run a container you will use the following command structure:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run &lt;IMAGE&gt; <span class="o">[</span>COMMAND]
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">IMAGE</code> is the docker image to run and <code class="language-plaintext highlighter-rouge">COMMAND</code> are optional commands to execute with the image. For an example of how this works you can run a bash shell in an Ubuntu 20.04 Docker image</p><p>Note</p><blockquote><p>the command below includes the <code class="language-plaintext highlighter-rouge">-it</code> flag so you get an interactive shell where you can type and run other commands.</p></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run <span class="nt">-it</span> ubuntu:20.04 bash
</pre></table></code></div></div><p>You can see that you’re now inside a new container. This is a completely different environment than you were previously working from.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>root@e84d633423a6:/# <span class="nb">cat</span> /etc/os-release
<span class="nv">NAME</span><span class="o">=</span><span class="s2">"Ubuntu"</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s2">"20.04.4 LTS (Focal Fossa)"</span>
<span class="nv">ID</span><span class="o">=</span>ubuntu
<span class="nv">ID_LIKE</span><span class="o">=</span>debian
<span class="nv">PRETTY_NAME</span><span class="o">=</span><span class="s2">"Ubuntu 20.04.4 LTS"</span>
<span class="nv">VERSION_ID</span><span class="o">=</span><span class="s2">"20.04"</span>
<span class="nv">HOME_URL</span><span class="o">=</span><span class="s2">"https://www.ubuntu.com/"</span>
<span class="nv">SUPPORT_URL</span><span class="o">=</span><span class="s2">"https://help.ubuntu.com/"</span>
<span class="nv">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">"https://bugs.launchpad.net/ubuntu/"</span>
<span class="nv">PRIVACY_POLICY_URL</span><span class="o">=</span><span class="s2">"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"</span>
<span class="nv">VERSION_CODENAME</span><span class="o">=</span>focal
<span class="nv">UBUNTU_CODENAME</span><span class="o">=</span>focal
</pre></table></code></div></div><p>Run a <code class="language-plaintext highlighter-rouge">ls -al</code> and you will see a list of files in the container you’re attached to. Docker images are self contained and will always run the same way for any system they run on. To see an example of this we’ll write some text into a file on this container.</p><p>Use <code class="language-plaintext highlighter-rouge">CTRL+D</code> to exit the container.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>root@e84d633423a6:/# <span class="nb">ls</span> <span class="nt">-al</span>
total 56
drwxr-xr-x   1 root root 4096 Jul 30 21:43 <span class="nb">.</span>
drwxr-xr-x   1 root root 4096 Jul 30 21:43 ..
<span class="nt">-rwxr-xr-x</span>   1 root root    0 Jul 30 21:43 .dockerenv
lrwxrwxrwx   1 root root    7 May 31 15:43 bin -&gt; usr/bin
drwxr-xr-x   2 root root 4096 Apr 15  2020 boot
drwxr-xr-x   5 root root  360 Jul 30 21:43 dev
drwxr-xr-x   1 root root 4096 Jul 30 21:43 etc
drwxr-xr-x   2 root root 4096 Apr 15  2020 home
drwxr-xr-x   2 root root 4096 May 31 15:43 media
drwxr-xr-x   2 root root 4096 May 31 15:43 mnt
...
root@e84d633423a6:/# <span class="nb">echo</span> <span class="s2">"Hello World!"</span> <span class="o">&gt;</span> text.txt
</pre></table></code></div></div><p>Run the same docker image again, the container should start much faster as you will not have to download the image again. Once connected run <code class="language-plaintext highlighter-rouge">ls -al</code> and look for your text.txt file, which you’ll notice is not there. Hit CTRL+D again and then run <code class="language-plaintext highlighter-rouge">docker ps -a</code> to list all of the containers on your system including ones that are stopped.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker ps <span class="nt">-a</span>
CONTAINER ID   IMAGE          COMMAND   CREATED              STATUS                     PORTS     NAMES
c85d55bb1f08   ubuntu:20.04   <span class="s2">"bash"</span>    About a minute ago   Exited <span class="o">(</span>0<span class="o">)</span> 8 seconds ago             wizardly_solomon
e84d633423a6   ubuntu:20.04   <span class="s2">"bash"</span>    11 minutes ago       Exited <span class="o">(</span>0<span class="o">)</span> 5 minutes ago             inspiring_ride

</pre></table></code></div></div><p>You can start a stopped container by using <code class="language-plaintext highlighter-rouge">docker start &lt;ID&gt;</code> command and set the ID from the CONTAINER ID column from the <code class="language-plaintext highlighter-rouge">docker ps</code> command. To start the first container we created and then attach an interactive prompt:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>mark@docker01:~<span class="nv">$ </span>docker start <span class="nt">-ia</span> e84d633423a6
root@e84d633423a6:/# <span class="nb">ls
</span>bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  text.txt  tmp  usr  var
root@e84d633423a6:/# <span class="nb">cat </span>text.txt
Hello World!
</pre></table></code></div></div><p>Each time you run <code class="language-plaintext highlighter-rouge">docker run</code> and the exit with <code class="language-plaintext highlighter-rouge">CTRL+D</code> you are leaving containers behind which take up disk space. You’ll want to make sure to clean these up with <code class="language-plaintext highlighter-rouge">docker rm &lt;CONTAINER_ID&gt;</code> where <code class="language-plaintext highlighter-rouge">CONTAINER_ID</code> is the ID from the <code class="language-plaintext highlighter-rouge">docker ps</code> command. Alternatively if you want the container to be removed automatically when you exit the container use the <code class="language-plaintext highlighter-rouge">--rm</code> flag in your <code class="language-plaintext highlighter-rouge">docker run</code> command.</p><h2 id="run-a-web-app-using-docker"><span class="mr-2">Run a web app using Docker</span><a href="#run-a-web-app-using-docker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Run a container that can be used to run a web app and try and access the web app.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run training/webapp &amp;
 <span class="k">*</span> Running on http://0.0.0.0:5000/ <span class="o">(</span>Press CTRL+C to quit<span class="o">)</span>
<span class="nv">$ </span>docker run training/webapp  <span class="k">*</span> Running on http://0.0.0.0:5000/ <span class="o">(</span>Press CTRL+C to quit<span class="o">)</span>
<span class="nv">$ </span>curl localhost:5000
curl: <span class="o">(</span>7<span class="o">)</span> Failed to connect to localhost port 5000 after 0 ms: Connection refused
</pre></table></code></div></div><p>Containers are isolated not just their file system but also from a networking perspective. The container is listening on port 5000 <i><b>inside</b></i> the container but we need to expose that port externally as well. To do so you use the <code class="language-plaintext highlighter-rouge">-p</code> switch with the <code class="language-plaintext highlighter-rouge">docker</code> command. Hit <code class="language-plaintext highlighter-rouge">CTRL+C</code> to shutdown the container and run the following.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run <span class="nt">-p</span> 5000:5000 training/webapp
 <span class="k">*</span> Running on http://0.0.0.0:5000/ <span class="o">(</span>Press CTRL+C to quit<span class="o">)</span>
</pre></table></code></div></div><p>Once it’s running you’ll be able to see the the app return results by opening a web browser to the server or using a <code class="language-plaintext highlighter-rouge">curl</code> command.</p><p><img data-src="/assets/2022-07-30-webapp-example.jpg" alt="Web App On Port 5000" data-proofer-ignore></p><h2 id="create-a-docker-image"><span class="mr-2">Create A Docker Image</span><a href="#create-a-docker-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we’ve used pre-built docker images so far from Docker Hub for <code class="language-plaintext highlighter-rouge">ubuntu:20.04</code> and <code class="language-plaintext highlighter-rouge">training/webapp</code> but what about creating your own docker image? For example imagine we had a folder called <code class="language-plaintext highlighter-rouge">web-server</code> that contained an <code class="language-plaintext highlighter-rouge">index.html</code> file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>&lt;html&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello World from Custom Docker!&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><p>We could accomplish this by createing something called a <code class="language-plaintext highlighter-rouge">dockerfile</code> in the <code class="language-plaintext highlighter-rouge">web-server</code> folder with the following contents.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>FROM python:3

WORKDIR /usr/src/app

COPY index.html <span class="nb">.</span>

CMD <span class="o">[</span><span class="s2">"python"</span>, <span class="s2">"-m"</span>, <span class="s2">"http.server"</span>, <span class="s2">"8000"</span><span class="o">]</span>
</pre></table></code></div></div><p>A Dockerfile is a text file that contains a series of commands in capital letters describe to Docker how to build a Docker image. For the dockerfile we defined previously it will do the following:</p><ul><li>FROM: This specifies the base image. The preceding code uses the official python image from Docker Hub, which, as you can probably guess, has Python already installed. One convenient thing about Docker is that you can build on top of officially-maintained images that have the dependencies you need already installed.<li>WORKDIR: This specifies the working directory for any subsequent commands. If the directory doesn’t already exist, Docker will create it.<li>COPY: This copies files from the host OS into the Docker image. The preceding code copies the index.html file into the Docker image<li>CMD: This specifies the default command to execute in the image when someone does docker run (if they don’t override the command). I’m using a Python command from the big list of HTTP server one-liners to fire up a simple web-server that will serve the index.html file on port 8000.</ul><p>To build a Docker image from your Dockerfile, go into the web-server folder, and run the docker build command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker build <span class="nt">-t</span> example-server <span class="nb">.</span>
</pre></table></code></div></div><p>Now you can run that image using the <code class="language-plaintext highlighter-rouge">docker run</code> command we used earlier. Make sure to include the <code class="language-plaintext highlighter-rouge">-p</code> switch to map port 8000 externally to the internal 8000 port</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run <span class="nt">-p</span> 8000:8000 example-server
</pre></table></code></div></div><p>Now if you open a web browser or curl to your <code class="language-plaintext highlighter-rouge">http://host:8000</code> you’ll see our web page returned. Going forward if that was a real application you wanted to deploy you could then use the <code class="language-plaintext highlighter-rouge">docker push</code> command to push it to a Docker Registry (requires an authorized account).</p><p><br /></p><h1 id="more-house-cleaning-commands">More House Cleaning Commands</h1><h2 id="tldr-how-to-stop-all-docker-containers"><span class="mr-2">TL;DR: How to Stop All Docker Containers</span><a href="#tldr-how-to-stop-all-docker-containers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To stop all Docker containers, simply run the following command in your terminal:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker <span class="nb">kill</span> <span class="si">$(</span>docker ps <span class="nt">-q</span><span class="si">)</span>
</pre></table></code></div></div><h3 id="how-it-works"><span class="mr-2">How It Works</span><a href="#how-it-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The docker ps command will list all running containers. The -q flag will only list the IDs for those containers. Once we have the list of all container IDs, we can simply run the docker kill command, passing all those IDs, and they’ll all be stopped!</p><h2 id="remove-all-docker-containers"><span class="mr-2">Remove All Docker Containers</span><a href="#remove-all-docker-containers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you don’t just want to stop containers and you’d like to go a step further and remove them, simply run the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker <span class="nb">rm</span> <span class="si">$(</span>docker ps <span class="nt">-a</span> <span class="nt">-q</span><span class="si">)</span>
</pre></table></code></div></div><h3 id="how-it-works-1"><span class="mr-2">How It Works</span><a href="#how-it-works-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We already know that docker ps -q will list all running container IDs. What is the -a flag? Well that will return all containers, not just the running ones. Therefore, this command will remove all containers including both running and stopped containers.</p><h2 id="how-to-remove-all-docker-images"><span class="mr-2">How To Remove All Docker Images</span><a href="#how-to-remove-all-docker-images" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To remove all Docker images, run this command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker rmi <span class="si">$(</span>docker images <span class="nt">-q</span><span class="si">)</span>
</pre></table></code></div></div><p>###How It Works docker images -q will list all image IDs. We pass these IDs to docker rmi (which stands for remove images) and we therefore remove all the images.</p><h2 id="prevent-running-containers-from-auto-restarting"><span class="mr-2">Prevent running containers from auto-restarting</span><a href="#prevent-running-containers-from-auto-restarting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Rational: Docker provides restart policies to control whether your containers start automatically when they exit, or when Docker restarts. This is often very useful when Docker is running a key service, this behavior however can prevent you from cleaning up old or unused containers if they’re still running.</p><h3 id="disable-all-auto-restarting-daemon-containers"><span class="mr-2">Disable <u>ALL</u> auto-restarting (daemon) containers.</span><a href="#disable-all-auto-restarting-daemon-containers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker update <span class="nt">--restart</span><span class="o">=</span>no <span class="si">$(</span>docker ps <span class="nt">-a</span> <span class="nt">-q</span><span class="si">)</span>
</pre></table></code></div></div><h3 id="use-the-following-to-disable-restart-a-single-container"><span class="mr-2">Use the following to disable restart a <u>SINGLE</u> container.</span><a href="#use-the-following-to-disable-restart-a-single-container" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker update <span class="nt">--restart</span><span class="o">=</span>no the-container-you-want-to-disable-restart
</pre></table></code></div></div><h3 id="note-docker-compose"><span class="mr-2">Note: docker-compose</span><a href="#note-docker-compose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-tip"><div><p>restart no is the default restart policy, and it does not restart a container under any circumstance. When always is specified, the container always restarts. The on-failure policy restarts a container if the exit code indicates an on-failure error.</p></div></blockquote><p>Docker-compose restart policies:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>restart: <span class="s2">"no"</span>
restart: always
restart: on-failure
restart: unless-stopped
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/homelab/'>homelab</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/homelab/" class="post-tag no-text-decoration" >homelab</a> <a href="/tags/ubuntu/" class="post-tag no-text-decoration" >ubuntu</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/terraform/" class="post-tag no-text-decoration" >terraform</a> <a href="/tags/ias/" class="post-tag no-text-decoration" >IaS</a> <a href="/tags/infrastructure-as-code/" class="post-tag no-text-decoration" >infrastructure as code</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Crash+Course+on+Docker%2C+Kubernetes%2C+Terraform%2C+and+AWS+-+Part+1%3A+Docker+-+Mark%27s+Documentation+Site&url=https%3A%2F%2Fdocs.chayde.com%2Fposts%2Fdocker-crash-course%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Crash+Course+on+Docker%2C+Kubernetes%2C+Terraform%2C+and+AWS+-+Part+1%3A+Docker+-+Mark%27s+Documentation+Site&u=https%3A%2F%2Fdocs.chayde.com%2Fposts%2Fdocker-crash-course%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdocs.chayde.com%2Fposts%2Fdocker-crash-course%2F&text=Crash+Course+on+Docker%2C+Kubernetes%2C+Terraform%2C+and+AWS+-+Part+1%3A+Docker+-+Mark%27s+Documentation+Site" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/self-hosted-git-repository/">Self-Hosted Git Repositories</a><li><a href="/posts/pihole-redirect-admin-to-root/">Redirect Pihole Admin Page</a><li><a href="/posts/homemade-pastrami/">Homemade Brisket Pastrami</a><li><a href="/posts/install-docker-and-docker-compose/">Install Docker and Docker compose</a><li><a href="/posts/ubuntu-cloud-init-notes/">Proxmox Ubuntu Cloud Init Template Notes</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/ubuntu/">ubuntu</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/pihole/">pihole</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a> <a class="post-tag" href="/tags/terraform/">terraform</a> <a class="post-tag" href="/tags/asa/">asa</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/docker-crash-course-p2/"><div class="card-body"> <em class="small" data-ts="1659272400" data-df="ll" > Jul 31, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 2: Kubernetes</h3><div class="text-muted small"><p> Kubernetes What is Kubernetes Kubernetes is an orchestration tool, which means it’s a tool for running and managing applications across a fleet of servers. More specifically, it’s a container orche...</p></div></div></a></div><div class="card"> <a href="/posts/install-docker-and-docker-compose/"><div class="card-body"> <em class="small" data-ts="1658670600" data-df="ll" > Jul 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Install Docker and Docker compose</h3><div class="text-muted small"><p> Install Docker sudo apt-get update sudo apt-get install -y \ apt-transport-https \ ca-certificates \ curl \ gnupg \ lsb-release curl -fsSL https://download.docker.com/linux/ubu...</p></div></div></a></div><div class="card"> <a href="/posts/reset-uptimekuma-password-from-docker/"><div class="card-body"> <em class="small" data-ts="1658671200" data-df="ll" > Jul 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reset Uptimekuma Password From Docker</h3><div class="text-muted small"><p> Uptimekuma Password Reset Login into uptimekuma.chayde.lab via SSH, then run the following command: docker exec -it uptime-kuma npm run reset-password</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/certificate-processes/" class="btn btn-outline-primary" prompt="Older"><p>OpenSSL Certificate Processes</p></a> <a href="/posts/docker-crash-course-p2/" class="btn btn-outline-primary" prompt="Newer"><p>Crash Course on Docker, Kubernetes, Terraform, and AWS - Part 2: Kubernetes</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/thechayde">Mark Riggs</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/ubuntu/">ubuntu</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/pihole/">pihole</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a> <a class="post-tag" href="/tags/terraform/">terraform</a> <a class="post-tag" href="/tags/asa/">asa</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
